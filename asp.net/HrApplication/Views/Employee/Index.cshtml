
@{
}
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    Add Employee
</button>

<div class="card">
    <h2 class="card-header">Employees / List</h2>
    <div class="card-body">
        <table class="table">
            <thead >
                <tr>
                    <th scope="col">#</th> 
                    <th scope="col">Name</th>
                    <th scope="col">Department</th>
                    <th scope="col">Job Title</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody id="tableContent">
                
                
            </tbody>
        </table>

    </div>

</div>




<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Add Employee</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="post" action="/Employee/save" id="EmployeeForm">

            <div class="modal-body">
                    <div class="mb-3">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" class="form-control" id="name" placeholder="name" name="name">
                    </div>

                    <div class="mb-3">
                        <label for="department" class="form-label">Department</label>
                        <input class="form-control" id="department" name="department" placeholder="Marketing" >
                    </div> 

                    <div class="mb-3">
                        <label for="jobTitle" class="form-label">Job Title</label>
                        <input class="form-control" id="jobTitle" name="jobTitle"  placeholder="Supervisor">
                    </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Save changes</button>
            </div>
            </form>

        </div>
    </div>
</div>

@section Scripts{
<script>

    $(document).on('submit', '#EmployeeForm', function (e) {
        e.preventDefault()


        $.post($(this).attr("action"), { 
            name: $("#name").val(), 
            department: $("#department").val(), 
            jobTitle:$("#jobTitle").val() 
        }).then(response => {

            if (response.success) {
                //hide the model
                $('#exampleModal').modal('hide');

                //refresh my table
                employeeTableRequest();


                //clear the form
                $("#EmployeeForm").trigger("reset")

            }

         })
        });


   $(document).ready(function () {
       employeeTableRequest();
   });

    function employeeTableRequest() {
            $.get("/Employee/Table").then(response => {
                console.log(response);

                if (response.success) {

                    $("#tableContent").html('');

                    response.list.forEach((element, index) => {

                        $("#tableContent").append(` <tr>
                                                            <th scope="row">${index + 1}</th>
                                                            <td>${element.name}</td>
                                                            <td>${element.department} </td>
                                                            <td>${element.jobTitle} </td>
                                                            <td></td>
                                                           </tr> `)


                    })
                }
            })

    }
    

</script>
}
